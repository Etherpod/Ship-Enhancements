using System.Text.Json;
using System.Text.Json.Nodes;
using System.Text.Json.Serialization.Metadata;
using DitzyExtensions.Collection;

namespace ShipEnhancements.Settings.Generator;

public static class PresetInjector
{
    public static readonly Dictionary<string, object> VanillaPlusSettings = new Dictionary<string, object>()
    {
        { "disableGravityCrystal", false },
        { "disableEjectButton", false },
        { "disableHeadlights", false },
        { "disableLandingCamera", false },
        { "disableShipLights", false },
        { "disableShipOxygen", false },
        { "oxygenDrainMultiplier", 1f },
        { "fuelDrainMultiplier", 1f },
        { "shipDamageMultiplier", 1f },
        { "shipDamageSpeedMultiplier", 1f },
        { "shipOxygenRefill", false },
        { "enableGravityLandingGear", false },
        { "disableAirAutoRoll", false },
        { "disableWaterAutoRoll", false },
        { "enableThrustModulator", false },
        { "temperatureZonesAmount", "All" },
        { "enableShipFuelTransfer", false },
        { "enableJetpackRefuelDrain", false },
        { "disableReferenceFrame", false },
        { "disableMapMarkers", false },
        { "gravityMultiplier", 1f },
        { "fuelTransferMultiplier", 1f },
        { "oxygenRefillMultiplier", 1f },
        { "temperatureResistanceMultiplier", 1f },
        { "enableAutoHatch", false },
        { "oxygenTankDrainMultiplier", 1f },
        { "fuelTankDrainMultiplier", 1f },
        { "atmosphereAngularDragMultiplier", 1f },
        { "spaceAngularDragMultiplier", 1f },
        { "disableRotationSpeedLimit", false },
        { "gravityDirection", "Down" },
        { "disableScoutRecall", false },
        { "disableScoutLaunching", false },
        { "enableScoutLauncherComponent", false },
        { "enableManualScoutRecall", false },
        { "enableShipItemPlacement", false },
        { "addPortableCampfire", false },
        //{ "keepHelmetOn", true },
        //{ "showWarningNotifications", true },
        { "shipExplosionMultiplier", 1f },
        { "shipBounciness", 0f },
        { "enableEnhancedAutopilot", false },
        { "shipInputLatency", 0f },
        { "addEngineSwitch", false },
        { "idleFuelConsumptionMultiplier", 0f },
        //{ "shipLightColor", "Default" },
        { "hotThrusters", false },
        { "extraNoise", false },
        //{ "interiorHullColor", "Default" },
        //{ "exteriorHullColor", "Default" },
        { "addTether", false },
        { "disableDamageIndicators", false },
        { "addShipSignal", false },
        { "reactorLifetimeMultiplier", 1f },
        { "shipFriction", 0.5f },
        { "enableSignalscopeComponent", false },
        { "rustLevel", 0f },
        { "dirtAccumulationTime", 0f },
        //{ "thrusterColor", "Default" },
        { "disableSeatbelt", false },
        { "addPortableTractorBeam", false },
        { "disableShipSuit", false },
        //{ "damageIndicatorColor1", "Default" },
        { "disableAutoLights", false },
        { "addExpeditionFlag", false },
        { "addFuelCanister", false },
        { "cycloneChaos", 0f },
        { "moreExplosionDamage", false },
        { "singleUseTractorBeam", false },
        { "disableThrusters", "None" },
        { "maxDirtAccumulation", 0.8f },
        { "shipWarpCoreType", "Disabled" },
        { "repairTimeMultiplier", 1f },
        { "airDragMultiplier", 1f },
        { "addShipClock", false },
        { "enableStunDamage", false },
        //{ "enableRepairConfirmation", false },
        { "enableRemovableGravityCrystal", false },
        { "randomHullDamage", 0f },
        { "randomComponentDamage", 0f },
        { "enableFragileShip", false },
        { "addErnesto", false },
        { "repairLimit", -1f },
        { "extraEjectButtons", false },
        { "preventSystemFailure", false },
        { "addShipCurtain", false },
        { "repairWrenchType", "Disabled" },
        { "funnySounds", false },
        //{ "alwaysAllowLockOn", true },
        { "disableShipMedkit", false },
        { "addRadio", false },
        { "disableFluidPrevention", false },
        { "disableHazardPrevention", false },
        { "prolongDigestion", false },
        { "unlimitedItems", false },
        { "noiseMultiplier", 1f },
        { "waterDamage", 0f },
        { "sandDamage", 0f },
        { "disableMinimapMarkers", false },
        { "scoutPhotoMode", false },
        { "enableAutoAlign", false },
        { "shipHornType", "None" },
        { "disableHatch", false },
        { "enableShipTemperature", false },
        { "temperatureDifficulty", 0.5f },
        { "passiveTemperatureGain", "None" },
        { "addResourcePump", false },
        { "addWaterTank", false },
        { "waterDrainMultiplier", 1f },
        { "addWaterCooling", false },
        { "enableReactorOverload", false },
        { "enableQuantumShip", false },
    };

    public static readonly Dictionary<string, object> MinimalSettings = new Dictionary<string, object>()
    {
        { "disableGravityCrystal", true },
        { "disableEjectButton", true },
        { "disableHeadlights", true },
        { "disableLandingCamera", true },
        { "disableShipLights", true },
        { "disableShipOxygen", true },
        { "oxygenDrainMultiplier", 1f },
        { "fuelDrainMultiplier", 1f },
        { "shipDamageMultiplier", 1f },
        { "shipDamageSpeedMultiplier", 1f },
        { "shipOxygenRefill", false },
        { "enableGravityLandingGear", false },
        { "disableAirAutoRoll", true },
        { "disableWaterAutoRoll", true },
        { "enableThrustModulator", false },
        { "temperatureZonesAmount", "All" },
        { "enableShipFuelTransfer", false },
        { "enableJetpackRefuelDrain", false },
        { "disableReferenceFrame", true },
        { "disableMapMarkers", true },
        { "gravityMultiplier", 1f },
        { "fuelTransferMultiplier", 1f },
        { "oxygenRefillMultiplier", 1f },
        { "temperatureResistanceMultiplier", 1f },
        { "enableAutoHatch", false },
        { "oxygenTankDrainMultiplier", 1f },
        { "fuelTankDrainMultiplier", 1f },
        { "atmosphereAngularDragMultiplier", 1f },
        { "spaceAngularDragMultiplier", 1f },
        { "disableRotationSpeedLimit", false },
        { "gravityDirection", "Down" },
        { "disableScoutRecall", true },
        { "disableScoutLaunching", true },
        { "enableScoutLauncherComponent", false },
        { "enableManualScoutRecall", true },
        { "enableShipItemPlacement", false },
        { "addPortableCampfire", false },
        //{ "keepHelmetOn", true },
        //{ "showWarningNotifications", true },
        { "shipExplosionMultiplier", 1f },
        { "shipBounciness", 0f },
        { "enableEnhancedAutopilot", false },
        { "shipInputLatency", 0f },
        { "addEngineSwitch", false },
        { "idleFuelConsumptionMultiplier", 0f },
        //{ "shipLightColor", "Default" },
        { "hotThrusters", false },
        { "extraNoise", false },
        //{ "interiorHullColor", "Default" },
        //{ "exteriorHullColor", "Default" },
        { "addTether", false },
        { "disableDamageIndicators", true },
        { "addShipSignal", false },
        { "reactorLifetimeMultiplier", 1f },
        { "shipFriction", 0.5f },
        { "enableSignalscopeComponent", false },
        { "rustLevel", 0f },
        { "dirtAccumulationTime", 0f },
        //{ "thrusterColor", "Default" },
        { "disableSeatbelt", true },
        { "addPortableTractorBeam", false },
        { "disableShipSuit", false },
        //{ "damageIndicatorColor1", "Default" },
        { "disableAutoLights", false },
        { "addExpeditionFlag", false },
        { "addFuelCanister", false },
        { "cycloneChaos", 0f },
        { "moreExplosionDamage", false },
        { "singleUseTractorBeam", true },
        { "disableThrusters", "Backward" },
        { "maxDirtAccumulation", 0.8f },
        { "shipWarpCoreType", "Disabled" },
        { "repairTimeMultiplier", 1f },
        { "airDragMultiplier", 1f },
        { "addShipClock", false },
        { "enableStunDamage", false },
        //{ "enableRepairConfirmation", true },
        { "enableRemovableGravityCrystal", false },
        { "randomHullDamage", 0f },
        { "randomComponentDamage", 0f },
        { "enableFragileShip", true },
        { "addErnesto", false },
        { "repairLimit", 12f },
        { "extraEjectButtons", false },
        { "preventSystemFailure", false },
        { "addShipCurtain", false },
        { "repairWrenchType", "Required" },
        { "funnySounds", false },
        //{ "alwaysAllowLockOn", true },
        { "disableShipMedkit", true },
        { "addRadio", false },
        { "disableFluidPrevention", true },
        { "disableHazardPrevention", false },
        { "prolongDigestion", false },
        { "unlimitedItems", false },
        { "noiseMultiplier", 1f },
        { "waterDamage", 0f },
        { "sandDamage", 0f },
        { "disableMinimapMarkers", true },
        { "scoutPhotoMode", false },
        { "enableAutoAlign", false },
        { "shipHornType", "None" },
        { "disableHatch", true },
        { "enableShipTemperature", false },
        { "temperatureDifficulty", 0.5f },
        { "passiveTemperatureGain", "None" },
        { "addResourcePump", false },
        { "addWaterTank", false },
        { "waterDrainMultiplier", 1f },
        { "addWaterCooling", false },
        { "enableReactorOverload", false },
        { "enableQuantumShip", false },
    };

    public static readonly Dictionary<string, object> ImpossibleSettings = new Dictionary<string, object>()
    {
        { "disableGravityCrystal", false },
        { "disableEjectButton", false },
        { "disableHeadlights", false },
        { "disableLandingCamera", false },
        { "disableShipLights", false },
        { "disableShipOxygen", false },
        { "oxygenDrainMultiplier", 200f },
        { "fuelDrainMultiplier", 8f },
        { "shipDamageMultiplier", 5f },
        { "shipDamageSpeedMultiplier", 0.3f },
        { "shipOxygenRefill", false },
        { "enableGravityLandingGear", false },
        { "disableAirAutoRoll", false },
        { "disableWaterAutoRoll", false },
        { "enableThrustModulator", false },
        { "temperatureZonesAmount", "All" },
        { "enableShipFuelTransfer", false },
        { "enableJetpackRefuelDrain", false },
        { "disableReferenceFrame", false },
        { "disableMapMarkers", false },
        { "gravityMultiplier", 1.5f },
        { "fuelTransferMultiplier", 1f },
        { "oxygenRefillMultiplier", 1f },
        { "temperatureResistanceMultiplier", 1f },
        { "enableAutoHatch", false },
        { "oxygenTankDrainMultiplier", 100f },
        { "fuelTankDrainMultiplier", 100f },
        { "atmosphereAngularDragMultiplier", 0.5f },
        { "spaceAngularDragMultiplier", 0f },
        { "disableRotationSpeedLimit", false },
        { "gravityDirection", "Down" },
        { "disableScoutRecall", false },
        { "disableScoutLaunching", false },
        { "enableScoutLauncherComponent", false },
        { "enableManualScoutRecall", false },
        { "enableShipItemPlacement", false },
        { "addPortableCampfire", false },
        //{ "keepHelmetOn", true },
        //{ "showWarningNotifications", true },
        { "shipExplosionMultiplier", 100f },
        { "shipBounciness", 1f },
        { "enableEnhancedAutopilot", false },
        { "shipInputLatency", 0f },
        { "addEngineSwitch", false },
        { "idleFuelConsumptionMultiplier", 0f },
        //{ "shipLightColor", "Default" },
        { "hotThrusters", false },
        { "extraNoise", true },
        //{ "interiorHullColor", "Default" },
        //{ "exteriorHullColor", "Default" },
        { "addTether", false },
        { "disableDamageIndicators", false },
        { "addShipSignal", false },
        { "reactorLifetimeMultiplier", 0.5f },
        { "shipFriction", 0f },
        { "enableSignalscopeComponent", false },
        { "rustLevel", 0.4f },
        { "dirtAccumulationTime", 120f },
        //{ "thrusterColor", "Default" },
        { "disableSeatbelt", false },
        { "addPortableTractorBeam", false },
        { "disableShipSuit", false },
        //{ "damageIndicatorColor1", "Default" },
        { "disableAutoLights", false },
        { "addExpeditionFlag", false },
        { "addFuelCanister", false },
        { "cycloneChaos", 1f },
        { "moreExplosionDamage", true },
        { "singleUseTractorBeam", false },
        { "disableThrusters", "None" },
        { "maxDirtAccumulation", 1f },
        { "shipWarpCoreType", "Disabled" },
        { "repairTimeMultiplier", 5f },
        { "airDragMultiplier", 0f },
        { "addShipClock", false },
        { "enableStunDamage", true },
        //{ "enableRepairConfirmation", false },
        { "enableRemovableGravityCrystal", false },
        { "randomHullDamage", 0f },
        { "randomComponentDamage", 0.1f },
        { "enableFragileShip", false },
        { "addErnesto", false },
        { "repairLimit", -1f },
        { "extraEjectButtons", false },
        { "preventSystemFailure", false },
        { "addShipCurtain", false },
        { "repairWrenchType", "Disabled" },
        { "funnySounds", false },
        //{ "alwaysAllowLockOn", true },
        { "disableShipMedkit", false },
        { "addRadio", false },
        { "disableFluidPrevention", false },
        { "disableHazardPrevention", false },
        { "prolongDigestion", false },
        { "unlimitedItems", false },
        { "noiseMultiplier", 5f },
        { "waterDamage", 1f },
        { "sandDamage", 1f },
        { "disableMinimapMarkers", false },
        { "scoutPhotoMode", false },
        { "enableAutoAlign", false },
        { "shipHornType", "None" },
        { "disableHatch", false },
        { "enableShipTemperature", false },
        { "temperatureDifficulty", 0.5f },
        { "passiveTemperatureGain", "None" },
        { "addResourcePump", false },
        { "addWaterTank", false },
        { "waterDrainMultiplier", 1f },
        { "addWaterCooling", false },
        { "enableReactorOverload", false },
        { "enableQuantumShip", true },
    };

    public static readonly Dictionary<string, object> NewStuffSettings = new Dictionary<string, object>()
    {
        { "disableGravityCrystal", false },
        { "disableEjectButton", false },
        { "disableHeadlights", false },
        { "disableLandingCamera", false },
        { "disableShipLights", false },
        { "disableShipOxygen", false },
        { "oxygenDrainMultiplier", 1f },
        { "fuelDrainMultiplier", 1f },
        { "shipDamageMultiplier", 1f },
        { "shipDamageSpeedMultiplier", 1f },
        { "shipOxygenRefill", true },
        { "enableGravityLandingGear", true },
        { "disableAirAutoRoll", true },
        { "disableWaterAutoRoll", false },
        { "enableThrustModulator", true },
        { "temperatureZonesAmount", "All" },
        { "enableShipFuelTransfer", true },
        { "enableJetpackRefuelDrain", true },
        { "disableReferenceFrame", false },
        { "disableMapMarkers", false },
        { "gravityMultiplier", 1f },
        { "fuelTransferMultiplier", 1f },
        { "oxygenRefillMultiplier", 1f },
        { "temperatureResistanceMultiplier", 1f },
        { "enableAutoHatch", false },
        { "oxygenTankDrainMultiplier", 1f },
        { "fuelTankDrainMultiplier", 1f },
        { "atmosphereAngularDragMultiplier", 1f },
        { "spaceAngularDragMultiplier", 1f },
        { "disableRotationSpeedLimit", false },
        { "gravityDirection", "Down" },
        { "disableScoutRecall", false },
        { "disableScoutLaunching", false },
        { "enableScoutLauncherComponent", true },
        { "enableManualScoutRecall", false },
        { "enableShipItemPlacement", true },
        { "addPortableCampfire", true },
        //{ "keepHelmetOn", true },
        //{ "showWarningNotifications", true },
        { "shipExplosionMultiplier", 1f },
        { "shipBounciness", 0f },
        { "enableEnhancedAutopilot", true },
        { "shipInputLatency", 0f },
        { "addEngineSwitch", true },
        { "idleFuelConsumptionMultiplier", 0f },
        //{ "shipLightColor", "Default" },
        { "hotThrusters", false },
        { "extraNoise", false },
        //{ "interiorHullColor", "Default" },
        //{ "exteriorHullColor", "Default" },
        { "addTether", true },
        { "disableDamageIndicators", false },
        { "addShipSignal", true },
        { "reactorLifetimeMultiplier", 1f },
        { "shipFriction", 0.5f },
        { "enableSignalscopeComponent", true },
        { "rustLevel", 0f },
        { "dirtAccumulationTime", 0f },
        //{ "thrusterColor", "Default" },
        { "disableSeatbelt", false },
        { "addPortableTractorBeam", true },
        { "disableShipSuit", false },
        //{ "damageIndicatorColor1", "Default" },
        { "disableAutoLights", true },
        { "addExpeditionFlag", true },
        { "addFuelCanister", true },
        { "cycloneChaos", 0f },
        { "moreExplosionDamage", false },
        { "singleUseTractorBeam", false },
        { "disableThrusters", "None" },
        { "maxDirtAccumulation", 0.8f },
        { "shipWarpCoreType", "Component" },
        { "repairTimeMultiplier", 1f },
        { "airDragMultiplier", 1f },
        { "addShipClock", true },
        { "enableStunDamage", false },
        //{ "enableRepairConfirmation", true },
        { "enableRemovableGravityCrystal", true },
        { "randomHullDamage", 0f },
        { "randomComponentDamage", 0f },
        { "enableFragileShip", false },
        { "addErnesto", false },
        { "repairLimit", -1f },
        { "extraEjectButtons", true },
        { "preventSystemFailure", true },
        { "addShipCurtain", true },
        { "repairWrenchType", "Enabled" },
        { "funnySounds", false },
        //{ "alwaysAllowLockOn", true },
        { "disableShipMedkit", false },
        { "addRadio", true },
        { "disableFluidPrevention", false },
        { "disableHazardPrevention", false },
        { "prolongDigestion", false },
        { "unlimitedItems", false },
        { "noiseMultiplier", 1f },
        { "waterDamage", 0f },
        { "sandDamage", 0f },
        { "disableMinimapMarkers", false },
        { "scoutPhotoMode", true },
        { "enableAutoAlign", true },
        { "shipHornType", "Default" },
        { "disableHatch", false },
        { "enableShipTemperature", true },
        { "temperatureDifficulty", 0.25f },
        { "passiveTemperatureGain", "None" },
        { "addResourcePump", true },
        { "addWaterTank", true },
        { "waterDrainMultiplier", 1f },
        { "addWaterCooling", true },
        { "enableReactorOverload", true },
        { "enableQuantumShip", false },
    };

    public static readonly Dictionary<string, object> PandemoniumSettings = new Dictionary<string, object>()
    {
        { "disableGravityCrystal", false },
        { "disableEjectButton", true },
        { "disableHeadlights", false },
        { "disableLandingCamera", true },
        { "disableShipLights", false },
        { "disableShipOxygen", false },
        { "oxygenDrainMultiplier", 400f },
        { "fuelDrainMultiplier", 8f },
        { "shipDamageMultiplier", 2f },
        { "shipDamageSpeedMultiplier", 0.4f },
        { "shipOxygenRefill", true },
        { "enableGravityLandingGear", true },
        { "disableAirAutoRoll", true },
        { "disableWaterAutoRoll", true },
        { "enableThrustModulator", true },
        { "temperatureZonesAmount", "All" },
        { "enableShipFuelTransfer", true },
        { "enableJetpackRefuelDrain", true },
        { "disableReferenceFrame", false },
        { "disableMapMarkers", false },
        { "gravityMultiplier", 0.2f },
        { "fuelTransferMultiplier", 5f },
        { "oxygenRefillMultiplier", 0.4f },
        { "temperatureResistanceMultiplier", 2f },
        { "enableAutoHatch", true },
        { "oxygenTankDrainMultiplier", 10f },
        { "fuelTankDrainMultiplier", 10f },
        { "atmosphereAngularDragMultiplier", 1.5f },
        { "spaceAngularDragMultiplier", 0.5f },
        { "disableRotationSpeedLimit", false },
        { "gravityDirection", "Random" },
        { "disableScoutRecall", false },
        { "disableScoutLaunching", false },
        { "enableScoutLauncherComponent", true },
        { "enableManualScoutRecall", true },
        { "enableShipItemPlacement", true },
        { "addPortableCampfire", true },
        //{ "keepHelmetOn", true },
        //{ "showWarningNotifications", true },
        { "shipExplosionMultiplier", 25f },
        { "shipBounciness", 0.5f },
        { "enableEnhancedAutopilot", true },
        { "shipInputLatency", 0f },
        { "addEngineSwitch", true },
        { "idleFuelConsumptionMultiplier", 1f },
        //{ "shipLightColor", "Rainbow" },
        { "hotThrusters", true },
        { "extraNoise", true },
        //{ "interiorHullColor", "Rainbow" },
        //{ "exteriorHullColor", "Rainbow" },
        { "addTether", true },
        { "disableDamageIndicators", true },
        { "addShipSignal", true },
        { "reactorLifetimeMultiplier", 0.5f },
        { "shipFriction", 0f },
        { "enableSignalscopeComponent", true },
        { "rustLevel", 0.5f },
        { "dirtAccumulationTime", 350f },
        //{ "thrusterColor", "Default" },
        { "disableSeatbelt", true },
        { "addPortableTractorBeam", true },
        { "disableShipSuit", false },
        //{ "damageIndicatorColor1", "Rainbow" },
        { "disableAutoLights", true },
        { "addExpeditionFlag", true },
        { "addFuelCanister", true },
        { "cycloneChaos", 1f },
        { "moreExplosionDamage", true },
        { "singleUseTractorBeam", true },
        { "disableThrusters", "None" },
        { "maxDirtAccumulation", 0.8f },
        { "shipWarpCoreType", "Component" },
        { "repairTimeMultiplier", 0.1f },
        { "airDragMultiplier", 0f },
        { "addShipClock", true },
        { "enableStunDamage", true },
        //{ "enableRepairConfirmation", true },
        { "enableRemovableGravityCrystal", true },
        { "randomHullDamage", 0.1f },
        { "randomComponentDamage", 0.1f },
        { "enableFragileShip", false },
        { "addErnesto", true },
        { "repairLimit", -1f },
        { "extraEjectButtons", true },
        { "preventSystemFailure", true },
        { "addShipCurtain", true },
        { "repairWrenchType", "Enabled" },
        { "funnySounds", false },
        //{ "alwaysAllowLockOn", true },
        { "disableShipMedkit", true },
        { "addRadio", true },
        { "disableFluidPrevention", true },
        { "disableHazardPrevention", true },
        { "prolongDigestion", true },
        { "unlimitedItems", false },
        { "noiseMultiplier", 1f },
        { "waterDamage", 0.5f },
        { "sandDamage", 0.5f },
        { "disableMinimapMarkers", false },
        { "scoutPhotoMode", true },
        { "enableAutoAlign", true },
        { "shipHornType", "Annoying" },
        { "disableHatch", false },
        { "enableShipTemperature", true },
        { "temperatureDifficulty", 1f },
        { "passiveTemperatureGain", "Hot" },
        { "addResourcePump", true },
        { "buttonsRequireFlightChair", false },
        { "addWaterTank", true },
        { "waterDrainMultiplier", 3f },
        { "addWaterCooling", true },
        { "enableReactorOverload", true },
        { "enableQuantumShip", true },
    };

    public static void InjectPresets()
    {
        var jsonText = File.ReadAllText("default-config.json");
        var config = JsonNode.Parse(jsonText)!;
        var settings = config["settings"]!;

        settings.AddPresetsFieldToSettings();

        settings.AddPresetToSettings("vanillaPlus", VanillaPlusSettings);
        settings.AddPresetToSettings("minimal", MinimalSettings);
        settings.AddPresetToSettings("impossible", ImpossibleSettings);
        settings.AddPresetToSettings("newStuff", NewStuffSettings);
        settings.AddPresetToSettings("pandemonium", PandemoniumSettings);

        var opts = new JsonSerializerOptions
        {
            TypeInfoResolver = new DefaultJsonTypeInfoResolver(),
            WriteIndented = true
        };
        File.WriteAllText("default-conf-updated.json", config.ToJsonString(opts));
    }

    private static void AddPresetsFieldToSettings(this JsonNode settings)
    {
        settings
            .AsObject()
            .Where(e => e.Value!["type"]!.ToString() != "separator")
            .ForEach(e => e.Value!["presets"] = new JsonObject());
    }

    private static void AddPresetToSettings(
        this JsonNode settings,
        string presetName,
        IDictionary<string, object> preset
    ) =>
        preset.ForEachEntry((setting, value) => settings[setting]!["presets"]![presetName] = JsonValue.Create(value));
}